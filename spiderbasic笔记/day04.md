## 正则的语法

**概念**:用事先定义好的一些**特定字符**,及这些**特定字符的组合**,组成一个**规则字符串**,这个规则字符串用来表达对字符串的一种**过滤逻辑**.

- 字符
  - `.` 能够匹配`\n`之外的所有字符
  - `\` 转义
  - `[ ]` 或的效果，从中选择一个， `[abc]+` 能够匹配多个;^ 表示取反.
  - `|` 或的效果
- 预定义的字符集(**大写表示取反**)
  - `\d` 数字 `[0-9]`
  - `\s` **空白**字符串，包含`空格、\n、\t`
  - `\w` 单词字符，`a-zA-Z0-9_`
- 数量词
  - `*` 匹配0次或者多次
  - `+` 能够匹配1次或者多次
  - `?` 能够匹配0-1次，让*，+非贪婪
  - `{m,n}` 对前一个字符对象取`m-n`次

## re模块的常用方法
- `re.match (从头找一个)`
- `re.search (找一个)`
- `re.findall("正则表达式","待匹配的字符串")`   #返回列表，或者是空列表
- `re.sub("regex","_","待替换的字符串")`   #返回字符串
- `re.compile("regex",re.S/re.DOTALL) `  # (编译)返回一个p模型,具有和re一样的方法 ,但是传递的参数不同
  - `p.findall("待匹配的字符串")`
  - `p.sub("_","待替换的字符串")`

## 原始字符串r
- 定义：特殊符号原本的字面意思
- 用途：
  - 正则中，能够忽略转义符号带来的影响，待匹配的字符串中有几个\，正则表达式中加上r，照着几个\即可
  - windows文件路径

## xpath语法//的使用

XPath(XML Path Language)是一门在**HTML/XML**文档中查找信息的语言,可用来在HTML/XML文档中对**元素的属性进行遍历**.

| 数据格式 | 描述                                      | 设计目标                                           |
| -------- | ----------------------------------------- | -------------------------------------------------- |
| XML      | Extensible Markup Language(可扩展语言)    | 被设计为**传输和存储数据**,其焦点是**数据的内容.** |
| HTML     | HyperText Markup Language(超文本标记语言) | **显示数据**以及如何更好显示数据                   |

#### 路径的相关方法

- `//a` html中所有的a
- `div//a` div中所有的a，包括div下的后代节点中的a
- `a//text()` a下的所有的文本

#### xpath @ 的使用  (获取属性的方法)

- `a/@href` 获取a的href的值
- `//a[@class='b']`

#### xpath text() 的使用(获取文本的方法)
- `a/text()` a下的文本
- `//a[text()='下一页']` 文本为下一页的a标签

非常常用的表达式

| 表达式       | 描述                                                         |
| ------------ | ------------------------------------------------------------ |
| **nodename** | **选中该元素。**                                             |
| **/**        | **从根节点选取、或者是元素和元素间的过渡。**                 |
| **//**       | **从匹配选择的当前节点选择文档中的节点，而不考虑它们的位置。** |
| **.**        | **选取当前节点。**                                           |
| **..**       | **选取当前节点的父节点。**                                   |
| **@**        | **选取属性。**                                               |
| **text()**   | **选取文本。**                                               |

#### xpath 选择特定位置
- `//a[1]` 第一个
- `//a[last()]` 最后一个
- `//a[last()-1]` 倒数第二个
- `//a[postion()<4]` 前三个

#### 选取未知节点

| 通配符 | 描述                 |
| ------ | -------------------- |
| *      | 匹配任何元素节点。   |
| @*     | 匹配任何属性节点。   |
| node() | 匹配任何类型的节点。 |

#### lxml模块的使用
```python
# -*- coding:utf-8 -*-
from lxml import etree

element = etree.HTML(bytes / str)  # 返回element
ret_list = element.xpath("xpath字符串")  # 返回列表

bytes = etree.tostring(element)  # 返回bytes类型字符串

# 代码中需要先分组，在提取数据

```
